# https://sequencediagram.org/

autoactivation
actor "UCloud User\nAlice#1234" as User

participantgroup #lightgreen ** UCloud\nNetwork**
participant "UCloud" as UCloud
database "UCloud DB" as UCloudDB
end

participantgroup #lightblue **Provider\nNetwork**
participantgroup #lightyellow **New components**
participant "Integration Module" as Provider
database "Integration DB" as UserDB
end
participantgroup #pink **Existing components**

participant "                                 HPC                                 " as HPC
end

end

User->UCloud: Connect with provider
UCloud->Provider: Alice#1234 wishes to connect
Provider-->UCloud: Redirect user to $URL
UCloud-->User: Redirect user to $URL
User->Provider: GET $URL
Provider-->User: Instructions on how to authenticate/request a user
note over User, UCloud: In this example the\ninstructions says to run a\ncommand on the HPC

User->HPC: Open SSH using an existing user
HPC-->User: OK
User->HPC: Connect to my UCloud account


HPC->Provider: Alice#1234 \nhas connected as \nalice@idp.example.com (UID 1100)
Provider->UserDB: Insert mapping between: \nAlice#1234 and alice@idp.example.com (UID 1100)
UserDB-->Provider: OK

Provider->UCloud: Mapping for Alice#1234 complete
UCloud->UCloudDB: Mark mapping as complete
UCloudDB-->UCloud: OK
UCloud-->Provider: OK
Provider-->HPC: OK
HPC-->User: OK


== Alice#1234 can now consume resources from the provider ==
